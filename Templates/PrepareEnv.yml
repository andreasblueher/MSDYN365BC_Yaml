# File: PrepareEnv.yml

steps:
- powershell: |
   Import-Module NVRAppDevOps -DisableNameChecking
   Import-Module navcontainerhelper -DisableNameChecking

   $Config = Read-ALConfiguration -Path .\ -Password $(UserPwd)
   Invoke-WebRequest -Uri "$(SignTool)" -UseBasicParsing -Method Get -OutFile "C:\Windows\System32\signtool.exe"
   Write-Host $Config
   $temp = "$(LicenseFile)"
   if ($temp -ne $null)
   {
     $Config | Init-ALEnvironment -Build $True -Password $(UserPwd) -LicenseFile $(LicenseFile)
   }
   else
   {
     $Config | Init-ALEnvironment -Build $True -Password $(UserPwd)
   }

  failOnStderr: true
  displayName: 'Prepare environment'
